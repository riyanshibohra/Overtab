<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Overtab - Results</title>
  <link rel="stylesheet" href="../styles/styles.css">
</head>
<body class="sidebar-body">
  
  <div class="sidebar-container">
    
    <div class="sidebar-header">
      <div class="sidebar-branding">
        <img src="../../icons/icon-48.png" alt="Overtab" class="sidebar-logo" />
        <div class="sidebar-title-group">
          <h1 class="sidebar-title">Overtab</h1>
          <p class="sidebar-subtitle">Page Insights</p>
        </div>
      </div>
      <button id="clear-btn" class="sidebar-clear-btn" title="Close sidebar">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <path d="M1 1L13 13M13 1L1 13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <div class="sidebar-tabs">
      <button class="sidebar-tab active" data-tab="result">
        <span class="tab-icon">📄</span>
        <span class="tab-label">Result</span>
      </button>
      <button class="sidebar-tab" data-tab="history">
        <span class="tab-icon">📜</span>
        <span class="tab-label">History</span>
      </button>
    </div>

    <div class="sidebar-content">
      
      <div id="result-tab" class="sidebar-tab-content active">
        
        <!-- Default empty state (no spinner) -->
        <div id="empty-state" class="sidebar-empty-state">
          <div class="empty-icon">💡</div>
          <h2>No results yet</h2>
          <p>Highlight text or right-click an image to see AI-powered explanations here.</p>
          <div class="empty-state-tips">
            <p><strong>Quick tips:</strong></p>
            <p>• Highlight text → Click Explain/Simplify/Translate</p>
            <p>• Right-click images → Describe with Overtab</p>
            <p>• Use Voice Command for questions</p>
            <p>• Press ESC to close tooltip</p>
          </div>
        </div>
        
        <!-- Active processing state -->
        <div id="loading-state" class="sidebar-loading-state hidden">
          <div class="loading-container">
            <div class="loading-spinner"></div>
            <div class="loading-text">
              <h4 id="loading-message">Analyzing text...</h4>
              <div class="loading-dots">
                <span></span><span></span><span></span>
              </div>
            </div>
          </div>
        </div>

        <div id="result-display" class="sidebar-result-display hidden">
          
          <!-- Results shown first -->
          <div class="result-sections">
            
            <div class="result-section" id="explanation-section">
              <div class="result-section-header">
                <span class="result-icon">💡</span>
                <h3>Explanation</h3>
                <button class="copy-btn" data-content="explanation" title="Copy to clipboard">📋</button>
              </div>
              <div class="result-section-content" id="explanation-content">
                Result will appear here...
              </div>
            </div>

            <div class="result-section hidden" id="simplified-section">
              <div class="result-section-header">
                <span class="result-icon">✨</span>
                <h3>Simplified (Like you're 10)</h3>
                <button class="copy-btn" data-content="simplified" title="Copy to clipboard">📋</button>
              </div>
              <div class="result-section-content" id="simplified-content">
                Result will appear here...
              </div>
            </div>

            <div class="result-section hidden" id="translation-section">
              <div class="result-section-header">
                <span class="result-icon">🌐</span>
                <h3>Translation</h3>
                <button class="copy-btn" data-content="translation" title="Copy to clipboard">📋</button>
              </div>
              <div class="result-section-content" id="translation-content">
                Result will appear here...
              </div>
            </div>

          </div>
          
          <!-- Source shown last (collapsible) -->
          <div class="result-source">
            <button class="result-source-toggle" id="source-toggle">
              <span class="result-source-label">📄 Source Text</span>
              <span class="toggle-icon">▼</span>
            </button>
            <div class="result-source-content" id="source-content">
              <span id="result-source-text" class="result-source-text">Selected text will appear here</span>
            </div>
          </div>
        </div>

      </div>

      <div id="history-tab" class="sidebar-tab-content">
        
        <div id="history-empty-state" class="history-empty-state">
          <div class="empty-icon">📜</div>
          <h2>No history yet</h2>
          <p>Your recent explanations will appear here.</p>
        </div>

        <div id="history-list" class="sidebar-history-list hidden"></div>

        <button id="clear-history-btn" class="sidebar-clear-history-btn hidden">
          Clear All History
        </button>

      </div>

    </div>

    <div class="sidebar-footer">
      <div class="sidebar-badge">
        <div class="status-indicator">
          <img src="../../icons/gemini-icon.svg" alt="Gemini" />
        </div>
        <span class="status-text">Powered by Gemini Nano</span>
        <span class="status-badge-label">ON-DEVICE</span>
      </div>
    </div>

  </div>

  <script src="../utils/storage-manager.js"></script>
  <script src="sidebar.js"></script>
</body>
</html>
